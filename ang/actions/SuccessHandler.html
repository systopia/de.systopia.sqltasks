<div class="crm-accordion-wrapper crm-sqltask-success relativePosition collapsed">
    <div class="crm-accordion-header accordion-header-custom active action-label">
        <label class="input-checkbox">
            <input ng-model="model['enabled']" style="cursor: pointer;" ng-true-value="'1'" ng-false-value="'0'" type="checkbox">
            &nbsp;
            {{ts('Success Handler')}}
        </label>
        <span ng-if="model['action_title']" class="sql-task-action-title">{{model['action_title']}}</span>
        <label class="header-delete-btn" ng-click="removeItemFromArray(index)">
            <i class="crm-i fa-trash header-delete"></i>
            {{ts('Delete')}}
        </label>
    </div>
    <div class="crm-accordion-body" style="display: none;">
        <div class="sql-task-action-template-wrapper">
            <action-template-select
                model='model'
                action-templates='actionTemplates'
                action-template='actionTemplate'>
            </action-template-select>
            <div class="clear"></div>
            <action-template-form
                model='model'
                action-templates='actionTemplates'
                action-template='actionTemplate'>
            </action-template-form>
        </div>
        <div class="sql-tasks">
            <action-additional-info model='model' fieldPrefix="'success_handler'" index='index'></action-additional-info>

            <div class="help sql-task-help" style="margin-left: 5px; margin-right: 5px;">
                {{ts('This action will be triggered after the')}}
                <strong>{{ts('successful')}}</strong>
                {{ts('execution of the task.')}}
            </div>

            <text-input model="model['table']" fieldlabel="ts('User Error Table')"
                        fieldid="'success_table' + index" showHelpIcon=true sizelength="60" inputMaxWidth="'500px'"
                        helpaction='onInfoPress("Error Table", "id-handler-error-table", "CRM\/Sqltasks\/Action\/ResultHandler")'>
            </text-input>

            <check-box model="model['drop_table']" fieldlabel="ts('Drop Error Table')"
                       fieldid="'success_drop_table' + index" showHelpIcon=true
                       helpaction='onInfoPress("Drop Error Table", "id-handler-error-table-drop", "CRM\/Sqltasks\/Action\/ResultHandler")'>
            </check-box>

            <text-input isrequired="getBooleanFromNumber(model['enabled'])"
                        model="model['email']" fieldlabel="ts('Email to')"
                        fieldid="'success_email'  + index" showHelpIcon=true inputMaxWidth="'300px'"
                        helpaction='onInfoPress("Email", "id-handler-email", "CRM\/Sqltasks\/Action\/ResultHandler")'>
            </text-input>

            <ordinary-select2 isrequired="getBooleanFromNumber(model['enabled'])" inputMaxWidth="'300px'"
                             model="model['email_template']" fieldlabel="ts('Email Template')"
                             fieldid="'success_email_template' + index" optionsArray="messageTemplateOptions"
                             isdataloaded="isDataLoaded('success_email_template' + index)">
            </ordinary-select2>

            <check-box model="model['always']" fieldlabel="ts('Execute always')"
                       fieldid="'success_always'  + index" showHelpIcon=true
                       helpaction='onInfoPress("Execute Always", "id-handler-always", "CRM\/Sqltasks\/Action\/ResultHandler")'>
            </check-box>

            <check-box model="model['attach_log']" fieldlabel="ts('Attach Log')"
                       fieldid="'success_attach_log' + index" showHelpIcon=true
                       helpaction='onInfoPress("Attach Log", "id-handler-attach-log", "CRM\/Sqltasks\/Action\/ResultHandler")'>
            </check-box>
        </div>
    </div>
</div>
