<div class="crm-accordion-wrapper crm-sqltask-api relativePosition collapsed">
    <div class="crm-accordion-header active accordion-header-custom action-label">
        <label class="input-checkbox">
            <input style="cursor: pointer;" ng-model="model['enabled']" ng-true-value="'1'" ng-false-value="'0'" type="checkbox">
            &nbsp;
            {{ts('APIv3 Call')}}
        </label>
        <span ng-if="model['action_title']" class="sql-task-action-title">{{model['action_title']}}</span>
        <label class="header-delete-btn" ng-click="removeItemFromArray(index)">
            <i class="crm-i fa-trash header-delete" role="img" aria-hidden="true"></i>
            {{ts('Delete')}}
        </label>
    </div>
    <div class="crm-accordion-body" style="display: none;">
        <div class="sql-task-action-template-wrapper">
            <action-template-select
                model='model'
                action-templates='actionTemplates'
                action-template='actionTemplate'>
            </action-template-select>
            <div class="clear"></div>
            <action-template-form
                model='model'
                action-templates='actionTemplates'
                action-template='actionTemplate'>
            </action-template-form>
        </div>
        <div class="sql-tasks">
            <action-additional-info model='model' fieldPrefix="'api_call'" index='index'></action-additional-info>

            <text-input isrequired="getBooleanFromNumber(model['enabled'])"
                    model="model['table']" fieldlabel="ts('Data Table')" fieldid="'api_table' + index"
                    sizelength="60" inputMaxWidth="'500px'"
                    showHelpIcon=true
                    helpaction='onInfoPress("Data Source", "id-api-data", "CRM\/Sqltasks\/Action\/APICall")'>
            </text-input>

            <text-input isrequired="getBooleanFromNumber(model['enabled'])"
                    model="model['entity']" fieldlabel="ts('Entity')" fieldid="'api_entity' + index"
                    showHelpIcon=true inputMaxWidth="'300px'"
                    helpaction='onInfoPress("Entity", "id-api-entity", "CRM\/Sqltasks\/Action\/APICall")'>
            </text-input>

            <text-input isrequired="getBooleanFromNumber(model['enabled'])"
                    model="model['action']" fieldlabel="ts('Action')" fieldid="'api_action' + index"
                    showHelpIcon=true inputMaxWidth="'300px'"
                    helpaction='onInfoPress("Action", "id-api-action", "CRM\/Sqltasks\/Action\/APICall")'>
            </text-input>

			<ordinary-select2 isrequired="getBooleanFromNumber(model['enabled'])"
							  showHelpIcon=true inputMaxWidth="'300px'"
							  model="model['handle_api_errors']" fieldlabel="ts('Error Handling')"
							  fieldid="'handle_api_errors' + index" optionsArray="handleApiErrorsData"
							  isdataloaded="isDataLoaded('handle_api_errors_index_' + index)"
							  helpaction='onInfoPress("Error Handling", "id-handle-api-errors", "CRM\/Sqltasks\/Action\/APICall")'>
			</ordinary-select2>

            <check-box
                model="model['store_api_results']"
                fieldid="'api_call_store_results' + index"
                fieldlabel="ts('Store API results')"
                helpaction="onInfoPress('Store API results', 'id-api-store-results', 'CRM\/Sqltasks\/Action\/APICall')"
                showHelpIcon="true">
            </check-box>

            <text-area isrequired="getBooleanFromNumber(model['parameters'])" model="model['parameters']"
                       fieldlabel="ts('Parameters')" fieldid="'api_call_parameters' + index" rowsnumber='8' inputMaxWidth="'500px'"
                       helpaction='onInfoPress("Columns", "id-api-parameters", "CRM\/Sqltasks\/Action\/APICall")'
                       showHelpIcon=true>
            </text-area>
        </div>
    </div>
</div>
